const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/countdownCollection-BgKcCPsp.js","assets/js/preload-helper-DmNsytk6.js","assets/js/VueBase-Qr0J4kll.js","assets/js/icon-alert-BG5stABd.js","assets/js/localStorage-BWL8dYsz.js","assets/js/string-VUUyAM1F.js","assets/js/index-DgGUECrr.js","assets/js/main-CWen-4ha.js","assets/css/index-C0DDMXTO.css","assets/js/index-CJJH83pl.js","assets/js/portal-vue.esm-CE661Bdg.js","assets/js/itemModelMixin-DaIj4M8Z.js","assets/js/reactiveCustomization-BIBQ0lmK.js","assets/js/namesMixin-DfNb5KMg.js","assets/js/itemDataServiceMixins-BlaFviuD.js","assets/js/metricMetadata-D4pZaGht.js","assets/js/clocks-DjzskNOU.js","assets/js/captureMixin-jTuhrD1f.js","assets/js/metricCollection-BqirDGTR.js","assets/js/clockCollection-DF00fXjh.js","assets/js/focusCollection-BPvAP_dg.js","assets/js/linksViewState-B5ZNAgQE.js","assets/js/ViewState-lXKIKVsa.js","assets/js/links-C846imK7.js","assets/js/compareObjects-BF7sSNEf.js","assets/js/tabsViewState-BIH6VAx8.js","assets/js/tabs-O40zJl9j.js","assets/js/focusModeViewState-CWig-aWL.js","assets/js/scenes-D8jpYIdj.js","assets/js/ocean-bubbles-GcKjBI5B.js","assets/js/PomodoroTimers-BWkB-14p.js","assets/js/pomodoroCompleted-DPMAO4eq.js","assets/js/loginHelpers-CfKnwmAb.js","assets/js/authService-DyVsAij2.js","assets/js/customization-D19fk4LU.js","assets/js/siteBlockerGroups-DPpCFrY4.js","assets/js/constants-BT5o8PmI.js","assets/js/siteBlockerSession-Dw_vX79E.js","assets/js/soundscapesState-COVG_fr_.js"])))=>i.map(i=>d[i]);
import{l as e,u as t,e as s,w as a,M as o,d as i,ac as n}from"./icon-alert-BG5stABd.js";import{A as l,S as c,p as r,g as d,M as u,C as p,V as b,B as f}from"./index-DgGUECrr.js";import{b as g,p as _}from"./reactiveCustomization-BIBQ0lmK.js";import{_ as w}from"./preload-helper-DmNsytk6.js";import{scenes as h}from"./scenes-D8jpYIdj.js";import{a as V}from"./PomodoroTimers-BWkB-14p.js";const y={countdowns:()=>S(w((()=>import("./countdownCollection-BgKcCPsp.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),metrics:()=>S(w((()=>import("./metricCollection-BqirDGTR.js").then((e=>e.b))),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10,14,11,12,13,15,16,17]))),clocks:()=>S(w((()=>import("./clockCollection-DF00fXjh.js")),__vite__mapDeps([19,1,2,3,4,5,6,7,8,9,10,14,11,12,13,15,16,17]))),focus:()=>S(w((()=>import("./focusCollection-BPvAP_dg.js")),__vite__mapDeps([20,2,3,4,1,5,6,7,8,9,10,11,12,13]))),linksViewStateStore:()=>S(w((()=>import("./linksViewState-B5ZNAgQE.js")),__vite__mapDeps([21,22,3,4,1,5,6,7,8]))),linksStore:()=>S(w((()=>import("./links-C846imK7.js").then((e=>e.l))),__vite__mapDeps([23,3,4,1,5,6,7,8,24]))),tabsViewStateStore:()=>S(w((()=>import("./tabsViewState-BIH6VAx8.js")),__vite__mapDeps([25,22,3,4,1,5,6,7,8]))),tabsStore:()=>S(w((()=>import("./tabs-O40zJl9j.js").then((e=>e.t))),__vite__mapDeps([26,3,4,1,5]))),focusModeViewStateStore:()=>S(w((()=>import("./focusModeViewState-CWig-aWL.js")),__vite__mapDeps([27,3,4,1,5,22,6,7,8,12,2,9,10,28,29,30]))),focusModeSessionStore:()=>S(w((()=>Promise.resolve().then((()=>T))),void 0))};async function S(e){return(await e).default}const E=()=>{localStorage.setItem(c,Date.now().toString())},A={pomodoro:{enable:async()=>{m.trigger("centerBelow:show",!1);const s=(await w((async()=>{const{default:e}=await import("./pomodoroCompleted-DPMAO4eq.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([31,3,4,1,5,6,7,8,30,12,2,9,10,32,33,34]))).default();return await e((()=>s.loaded)).toBe(!0),s.playing||await s.switchTo(V.Focus,{playSounds:!0}),t.delay(l).then((async()=>{m.trigger("pomodoro:focusPromptIfFocusEmpty"),await t.delay(l),m.trigger("pomodoro:focusPromptIfFocusEmpty")})),!0},disable:async()=>{const t=(await w((async()=>{const{default:e}=await import("./pomodoroCompleted-DPMAO4eq.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([31,3,4,1,5,6,7,8,30,12,2,9,10,32,33,34]))).default();await e((()=>t.loaded)).toBe(!0),await t.complete({switchAfterComplete:!1,completedManually:!0})}},siteBlocker:{enable:async()=>{const e=(await w((async()=>{const{default:e}=await import("./siteBlockerGroups-DPpCFrY4.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([35,3,4,1,5,36,24]))).default(),t=(await w((async()=>{const{default:e}=await import("./siteBlockerGroups-DPpCFrY4.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([35,3,4,1,5,36,24]))).default();e.refresh(),t.refresh();return(await w((async()=>{const{default:e}=await import("./siteBlockerSession-Dw_vX79E.js");return{default:e}}),__vite__mapDeps([37,3,4,1,5,6,7,8,35,36,24,27,22,12,2,9,10,28,29,30,31,32,33,34]))).default().active},disable:async({enableResult:e,focusing:t})=>{if(t)return;(await w((async()=>{const{default:e}=await import("./siteBlockerSession-Dw_vX79E.js");return{default:e}}),__vite__mapDeps([37,3,4,1,5,6,7,8,35,36,24,27,22,12,2,9,10,28,29,30,31,32,33,34]))).default().toggleActive(!!e)},shouldEnableOnResume:()=>!0,shouldRemoveDataOnSettingsChangeWhileFocusing:!1},soundscapes:{enable:async e=>{var a,o;"soundscapesIsReady"in m.widgetManager&&m.widgetManager.soundscapesIsReady||await new Promise((e=>{m.once("soundscapes:created",e)}));const i=(await w((async()=>{const{default:e}=await import("./soundscapesState-COVG_fr_.js");return{default:e}}),__vite__mapDeps([38,2,3,4,1,5,6,7,8,9,10]))).default;s.sendCrossTabMessage("soundscapes:stop"),m.trigger("soundscapes:stop"),m.trigger("soundscapes:togglePopup",!1);let n=null==(o=null==(a=g.focusModeSettings.apps)?void 0:a.soundscapes)?void 0:o.preset;return n&&"Random"!==n||(n=e&&"string"==typeof e?e:t.getRandomItem(h.filter((e=>!["Random","Custom","Noise","Binaural"].includes(e.name)))).name),m.trigger("soundscapes:play",n),i.globalPlaying||(i.globalPlaying=!0),addEventListener("beforeunload",E),n},disable:()=>{m.trigger("soundscapes:stop"),s.sendCrossTabMessage("soundscapes:stop"),removeEventListener("beforeunload",E),localStorage.removeItem(c)},shouldEnableOnResume:()=>{const e=Number(localStorage.getItem(c));return localStorage.removeItem(c),!!(e&&!isNaN(e)&&e>Date.now()-3e4)},shouldDisableEnableOnSettingChangeWhileFocusing:!0},tabStash:{enable:()=>{},disable:async({enableResult:e,inactive:s})=>{var o;if(s)return;const i=(await y.tabsStore())();if(i.loaded&&!i.loading||(await new Promise((e=>{a((()=>i.loaded),e),i.loading||i.refresh()})),await t.delay(1e3)),m.conditionalFeatures.featureEnabled("plus")||m.conditionalFeatures.featureEnabled("tab-stash-degraded")||(e=null==(o=i.getItems[0])?void 0:o.id),"string"==typeof e){const t=i.getItemById(e);t&&await i.restoreSession(t)}},get unsupported(){return t.isSafari()||t.isPwa()}}},I=["siteBlocker","soundscapes","tabStash"];let v;const M=r((({loadedRef:e,updateAsync:s})=>i("focusModeSession",{state:()=>({start:1,stop:1,appActivationData:{},capacityLimitInfo:{msUsed:0,date:t.getDateOnly(new Date)},lastInteraction:Date.now(),totalTimeFocused:0}),getters:{focusModeActive:e=>!e.stop,loaded:()=>e.value,capacityLimitInfoForToday(){const e=this.capacityLimitInfo,s=m.models.date.get("date"),a=t.getDateOnly(s);return e.date!==a?{date:a,msUsed:0}:e},msUntilOverCapacityLimit(){const e=p,t=this.capacityLimitInfoForToday.msUsed,s=m.models.date.get("seconds").getTime();return e-(t+(this.focusModeActive?s-this.start:0))},isOverCapacityLimit(){return this.msUntilOverCapacityLimit<=0},shouldAutoDisable(){const e=m.models.date.get("date").getTime();return this.focusModeActive&&this.lastInteraction<e-u},totalTimeFocusedIncludingCurrentSession(){const e=m.models.date.get("date").getTime();let t=this.totalTimeFocused;return this.focusModeActive&&(t+=e-this.start),Math.max(t,0)}},actions:{async update(e){await s(e)},async stopAndSaveFocusMode(){const e=this.capacityLimitInfoForToday,t=Date.now(),s=t-this.start;e.msUsed+=s;const a=this.totalTimeFocused+s;await this.update({stop:t,capacityLimitInfo:e,totalTimeFocused:a,appActivationData:{}}),this.refreshLastInteraction({debounceTime:0})},async startAndSaveFocusMode(e){const t=this.capacityLimitInfoForToday;await this.update({start:Date.now(),stop:null,appActivationData:e,capacityLimitInfo:t}),this.refreshLastInteraction({debounceTime:0})},refreshLastInteraction({debounceTime:e=3e3}){this.focusModeActive&&(clearTimeout(v),v=window.setTimeout((()=>{this.update({lastInteraction:Date.now()})}),e))},async disableAppsBeforeStop(e){for(const t of I){const s=A[t];s.unsupported||await s.disable({enableResult:this.appActivationData[t],inactive:e})}}}})),{mode:o.Cache,syncAutomatically:!0});(async()=>{const t=M();await e((()=>t.loaded)).toBe(!0),d.switchOverToWatchedStoreItem((()=>t.focusModeActive))})();const T=Object.freeze(Object.defineProperty({__proto__:null,default:M,useFocusModeSessionStore:M},Symbol.toStringTag,{value:"Module"})),D=()=>{const e=g.focusModeSettings,t=JSON.parse(m.models.customization.persistentSettings.defaultIfNotSet.focusModeSettingsStr);return e.apps={...t.apps,...e.apps},{...t,...e}},L=()=>_,O=async(e,t,s)=>{const a=L().focusModeSettings;a.apps[e]||(a.apps[e]={enabled:!1}),a.apps[e][t]=s,L().focusModeSettings=a,M().focusModeActive&&(await(async(e,t)=>{const s=M(),a=s.appActivationData||{};if(t){const t=await A[e].enable();if(null==t)return;a[e]=t}else await A[e].disable({enableResult:a[e],focusing:!0}),(A[e].shouldRemoveDataOnSettingsChangeWhileFocusing??1)&&delete a[e];await s.update({appActivationData:a})})(e,s),R())},R=()=>{const e=D(),t={notesVisible:e.notesVisible,todoVisible:e.todoVisible,quoteVisible:!1,siteBlockerVisible:e.apps.siteBlocker.enabled,soundscapesVisible:e.apps.soundscapes.enabled,tabsVisible:e.apps.tabStash.enabled,focusVisible:!0,centerBelowNavVisible:e.searchVisible,searchVisible:!1,launchpadVisible:!1,focusModeVisible:!0,askAiVisible:e.askAiVisible,linksVisible:e.linksVisible,metricVisible:e.metricsVisible,countdownVisible:e.countdownsVisible,multiClockVisible:e.worldClocksVisible,focusInsightVisible:e.focusInsightVisible,weatherVisible:!1};n(t)},P=()=>{m.widgetManager.addVueAppExemption(b,"focusMode"),m.widgetManager.addAppExemption(f,"focusMode")},k=()=>{m.widgetManager.hideApps({layer:"focusMode"}),m.widgetManager.removeVueAppExemption(b,"focusMode"),m.widgetManager.removeAppExemption(f,"focusMode")},j=()=>{n({soundscapesVisible:!!m.conditionalFeatures.featureEnabled("plus")&&null,tabsVisible:!(!m.conditionalFeatures.featureEnabled("tab-stash-degraded")&&!m.conditionalFeatures.featureEnabled("plus"))&&null,notesVisible:null,todoVisible:null,quoteVisible:null,siteBlockerVisible:null,focusVisible:null,centerBelowNavVisible:null,searchVisible:null,launchpadVisible:null,focusModeVisible:null,askAiVisible:null,linksVisible:null,metricVisible:null,countdownVisible:null,multiClockVisible:null,focusInsightVisible:null,weatherVisible:null})},F=async()=>{if(d.currentValue){const e=(await y.focusModeSessionStore())();await e.disableAppsBeforeStop(!1),await e.stopAndSaveFocusMode()}};export{P as a,j as b,A as c,L as d,O as e,F as f,D as g,T as h,y as i,k as r,R as s,M as u};